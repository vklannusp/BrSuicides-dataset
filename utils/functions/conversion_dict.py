conversion_dictionaries = {
    # "ACIDTRAB": {
    #     "1": "Sim",
    #     "2": "Não",
    #     "9": "Ignorado"
    # },
    # "ALTCAUSA": {
    #     "1": "Sim",
    #     "2": "Não",
    # },
    # "ASSISTMED": {
    #     "1": "Sim",
    #     "2": "Não",
    #     "9": "Ignorado"
    # },
    # "ATESTANTE": {
    #     "1": "Sim",
    #     "2": "Substituto",
    #     "3": "IML",
    #     "4": "SVO",
    #     "5": "Outros"
    # },
    # "CIRCOBITO": {
    #     "1": "Acidente",
    #     "2": "Suicídio",
    #     "3": "Homicídio",
    #     "4": "Outros",
    #     "9": "Ignorado"
    # },
    # "CIRURGIA": {
    #     "1": "Sim",
    #     "2": "Não",
    #     "9": "Ignorado"
    # },
    # "CODIFICADO": {
    #     "S": "Sim",
    #     "N": "Não"
    # },
    "ESC": {
        "0": "",
        "1": "Nenhuma",
        "2": "1 a 3 anos",
        "3": "4 a 7 anos",
        "4": "8 a 11 anos",
        "5": "12 anos e mais",
        "9": "Ignorado"
    },
    "ESC2010": {
        "0": "Sem escolaridade",
        "1": "Fundamental I (1ª a 4ª série)",
        "2": "Fundamental II (5ª a 8ª série)",
        "3": "Médio (antigo 2º Grau)",
        "4": "Superior incompleto",
        "5": "Superior completo",
        "9": "Ignorado"
    },
    "ESCFALAGR1": {
        "00": "Sem escolaridade",
        "01": "Fundamental I Incompleto",
        "02": "Fundamental I Completo",
        "03": "Fundamental II Incompleto",
        "04": "Fundamental II Completo",
        "05": "Ensino Médio Incompleto",
        "06": "Ensino Médio Completo",
        "07": "Superior Incompleto",
        "08": "Superior Completo",
        "09": "Ignorado",
        "10": "Fundamental I Incompleto ou Inespecífico",
        "11": "Fundamental II Incompleto ou Inespecífico",
        "12": "Ensino Médio Incompleto ou Inespecífico"
    },
    # "ESCMAE": {
    #     "1": "Nenhuma",
    #     "2": "de 1 a 3 anos",
    #     "3": "de 4 a 7 anos",
    #     "4": "de 8 a 11 anos",
    #     "5": "12 anos e mais",
    #     "9": "Ignorado"
    # },
    # "ESCMAE2010": {
    #     "0": "Sem escolaridade",
    #     "1": "Fundamental I (1ª a 4ª série)",
    #     "2": "Fundamental II (5ª a 8ª série)",
    #     "3": "Médio (antigo 2º Grau)",
    #     "4": "Superior incompleto",
    #     "5": "Superior completo",
    #     "9": "Ignorado"
    # },
    # "ESCMAEAGR1": {
    #     "00": "Sem escolaridade",
    #     "01": "Fundamental I Incompleto",
    #     "02": "Fundamental I Completo",
    #     "03": "Fundamental II Incompleto",
    #     "04": "Fundamental II Completo",
    #     "05": "Ensino Médio Incompleto",
    #     "06": "Ensino Médio Completo",
    #     "07": "Superior Incompleto",
    #     "08": "Superior Completo",
    #     "09": "Ignorado",
    #     "10": "Fundamental I Incompleto ou Inespecífico",
    #     "11": "Fundamental II Incompleto ou Inespecífico",
    #     "12": "Ensino Médio Incompleto ou Inespecífico"
    # },
    "ESTCIV": {
        "1": "Solteiro",
        "2": "Casado",
        "3": "Viúvo",
        "4": "Separado judicialmente",
        "5": "União consensual",
        "9": "Ignorado"
    },
    # "ESTCIVIL": {
    #     "1": "Solteiro",
    #     "2": "Casado",
    #     "3": "Viúvo",
    #     "4": "Separado judicialmente",
    #     "5": "União consensual",
    #     "9": "Ignorado"
    # },
    # "EXAME": {
    #     "1": "Sim",
    #     "2": "Não",
    #     "9": "Ignorado"
    # },
    # "FONTE": {
    #     "1": "ocorrência policial",
    #     "2": "hospital",
    #     "3": "família",
    #     "4": "outra",
    #     "9": "ignorado"
    # },
    # "FONTEINV": {
    #     "1": "Comitê de Morte Materna e/ou Infantil",
    #     "2": "Visita domiciliar / Entrevista família",
    #     "3": "Estabelecimento de Saúde / Prontuário",
    #     "4": "Relacionando com outros bancos de dados",
    #     "5": "S V O",
    #     "6": "I M L",
    #     "7": "Outra fonte",
    #     "8": "Múltiplas fontes",
    #     "9": "Ignorado"
    # },
    # "GESTACAO": {
    #     "1": "Menos de 22 semanas",
    #     "2": "22 a 27 semanas",
    #     "3": "28 a 31 semanas",
    #     "4": "32 a 36 semanas",
    #     "5": "37 a 41 semanas",
    #     "6": "42 e + semanas"
    # },
    # "GRAVIDEZ": {
    #     "1": "única",
    #     "2": "dupla",
    #     "3": "tripla e mais",
    #     "9": "ignorada"
    # },
    # "INSTRUCAO": {
    #     "0": "Ignorado",
    #     "1": "Nenhuma",
    #     "2": "Primeiro grau",
    #     "3": "Segundo grau",
    #     "4": "Superior"
    # },
    # "LOCACID": {
    #     "0": "Ignorado",
    #     "1": "Via Pública",
    #     "2": "Domicílio",
    #     "3": "Outro",
    #     "4": "Local de trabalho"
    # },
    "LOCOCOR": {
        "1": "hospital",
        "2": "outros estabelecimentos de saúde",
        "3": "domicílio",
        "4": "via pública",
        "5": "outros",
        "6": "aldeia indígena",
        "9": "ignorado"
    },
    # "MORTEPARTO": {
    #     "1": "antes",
    #     "2": "durante",
    #     "3": "depois",
    #     "9": "ignorado"
    # },
    # "NECROPSIA": {
    #     "1": "sim",
    #     "2": "não",
    #     "9": "ignorado"
    # },
    # "OBITOGRAV": {
    #     "1": "sim",
    #     "2": "não",
    #     "9": "ignorado"
    # },
    # "OCUP": {
    #     # Ocupation doesn't have a dictionary that fits here,
    #     # it's handled later
    # },
    # "OBITOFE1": {
    #     "0": "Ignorado",
    #     "1": "Sim",
    #     "2": "Não"
    # },
    # "OBITOFE2": {
    #     "0": "Ignorado",
    #     "1": "Sim",
    #     "2": "Não"
    # },
    # "OBITOPARTO": {
    #     "1": "antes",
    #     "2": "durante",
    #     "3": "depois",
    #     "9": "Ignorado"
    # },
    # "OBITOPUERP": {
    #     "1": "Sim, até 42 dias após o parto",
    #     "2": "Sim, de 43 dias a 1 ano",
    #     "3": "Não",
    #     "9": "Ignorado"
    # },
    # "ORIGEM": {
    #     "1": "Oracle",
    #     "2": "Banco estadual disponibilizado via FTP",
    #     "3": "Banco SEADE",
    #     "9": "Ignorado"
    # },
    # "PARTO": {
    #     "1": "vaginal",
    #     "2": "cesáreo",
    #     "9": "Ignorado"
    # },
    # "QTDFILMORT": {
    #     "9": "Ignorado"
    # },
    # "QTDFILVIVO": {
    #     "9": "Ignorado"
    # },
    "RACACOR": {
        "1": "Branca",
        "2": "Preta",
        "3": "Amarela",
        "4": "Parda",
        "5": "Indígena"
    },
    # "SEMANGEST": {
    #     "0": "Ignorado",
    #     "1": "Menos de 20 semanas",
    #     "2": "20 a 27 semanas",
    #     "3": "28 e mais semanas",
    #     "4": "Menos de 21 semanas",
    #     "5": "22 a 27 semanas",
    #     "6": "28 a 36 semanas",
    #     "7": "37 a 41 semanas",
    #     "8": "42 semanas e mais"
    # },
    "SEXO": {
        "1": "masculino",
        "2": "feminino",
        "0": "Ignorado",
        "9": "Ignorado",
    },
    # "STDONOVA": {
    #     "1": "Sim",
    #     "0": "Não"
    # },
    # "STDOEPIDEM": {
    #     "1": "Sim",
    #     "0": "Não"
    # },
    # "STCODIFICA": {
    #     "S": "Sim",
    #     "N": "Não"
    # },
    # "TIPOACID": {
    #     "0": "Ignorado",
    #     "1": "Atropelamento",
    #     "2": "Demais acidentes de transito",
    #     "3": "Queda",
    #     "4": "Afogamento",
    #     "5": "Outros tipos de acidente"
    # },
    # "TIPOBITO": {
    #     "1": "Fetal",
    #     "2": "Não Fetal"
    # },
    # "TIPOGRAV": {
    #     "0": "Ignorado",
    #     "1": "Única",
    #     "2": "Dupla",
    #     "3": "Tríplice",
    #     "4": "Mais de 3"
    # },
    # "TIPOPARTO": {
    #     "0": "Ignorado",
    #     "1": "Espontâneo",
    #     "2": "Operatório",
    #     "3": "Forceps",
    #     "4": "Outro"
    # },
    # "TIPOVIOL": {
    #     "0": "Ignorado",
    #     "1": "Homicídio",
    #     "2": "Suicídio",
    #     "3": "Acidente",
    #     "4": "Outros tipos de violência"
    # },
    # "TPMORTEOCO": {
    #     "1": "na gravidez",
    #     "2": "no parto",
    #     "3": "no abortamento",
    #     "4": "até 42 dias após o término do parto",
    #     "5": "de 43 dias a 1 ano após o término da gestação",
    #     "8": "não ocorreu nestes períodos",
    #     "9": "ignorado"
    # },
    # "TPNIVELINV": {
    #     "E": "estadual",
    #     "R": "regional",
    #     "M": "Municipal"
    # },
    # "TPOBITOCOR": {
    #     "1": "Durante a gestação",
    #     "2": "Durante o abortamento",
    #     "3": "Após o abortamento",
    #     "4": "No parto ou até 1 hora após o parto",
    #     "5": "No puerpério - até 42 dias após o parto",
    #     "6": "Entre 43 dias e 1 ano após o parto",
    #     "7": "A investigação não identificou o momento do óbito",
    #     "8": "Mais de um ano após o parto",
    #     "9": "Não ocorreu nas circunstâncias anteriores",
    #     "Branco": "Não investigado"
    # },
    # "TPPOS": {
    #     "1": "sim",
    #     "2": "não"
    # },
    # "TPRESGINF": {
    #     "01": "Não acrescentou nem corrigiu informação",
    #     "02": "Sim, permitiu o resgate de novas informações",
    #     "03": "Sim, permitiu a correção de alguma das causas informadas originalmente"
    # }
}

def get_conversion_dict():
    return conversion_dictionaries

def reverse_conversion_dict(conversion_dict):
    reversed_dict = {}
    for col, mapping in conversion_dict.items():
        reversed_dict[col] = {v: k for k, v in mapping.items()}
    return reversed_dict

def convert_mapped_values(df, conversion_dict, cols_to_convert, list_of_nulls):
    for col in cols_to_convert:
        if col in conversion_dict:
            df[col] = df[col].map(conversion_dict[col])

            for null_col, null_val in list_of_nulls:
                if col == null_col:
                    df[col] = df[col].replace(null_val, np.nan)
    
    return df

if __name__ == "__main__":
    print('Possible nº of categorical data needing conversion: ', len(conversion_dictionaries.keys()))